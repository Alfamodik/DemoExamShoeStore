@page
@model ShoeStore.Web.Pages.SearchCatalogModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <title>Каталог</title>
    <link rel="stylesheet" href="~/css/catalog.css" asp-append-version="true" />
    <link rel="icon" href="~/Resources/Icon.ico" />
</head>
<body>

    <form method="get" class="search-form">
        <input type="hidden" name="accessRights" value="@(Model.AccessRights.HasValue ? Model.AccessRights.ToString() : "")" />

        <div class="catalog-header">
            <img src="~/Resources/Icon.png" class="catalog-icon" alt="icon" />
            <h1 class="catalog-title">Каталог</h1>
            <div class="logout-form">
                <a class="btn-logout" href="/Login">Назад</a>
            </div>
        </div>

        <div class="filters">
            <select name="selectedSupplier" onchange="this.form.submit()" class="filter-input">
                <option value="">Все поставщики</option>
                @foreach (var s in Model.Suppliers)
                {
                    <option value="@s" selected="@(s == Model.SelectedSupplier)">@s</option>
                }
            </select>

            <select name="sortType" onchange="this.form.submit()" class="filter-input">
                <option value="desc" selected="@(Model.SortType == "desc")">По убыванию</option>
                <option value="asc" selected="@(Model.SortType == "asc")">По возрастанию</option>
            </select>

            <input name="searchText" value="@Model.SearchText" placeholder="Поиск..." class="filter-input search-bar" />
        </div>

        <div class="actions">
            <a class="btn-add" href="/ProductEditWindow?accessRights=@Model.AccessRights">Добавить товар</a>
        </div>

        @if (Model.AccessRights == Core.AccessRights.Manager || Model.AccessRights == Core.AccessRights.Admin)
        {
            <div class="actions">
                <a class="btn-add" href="/Orders?accessRights=@Model.AccessRights">Заказы</a>
            </div>
        }

        <div class="products-list">
            @if (!Model.Products.Any())
            {
                <div class="no-products">Товаров нет.</div>
            }
            else
            {
                @foreach (var product in Model.Products!)
                {
                    @await Html.PartialAsync("ProductUserControl", product, new ViewDataDictionary(ViewData)
                   {
                       ["AccessRights"] = Model.AccessRights
                   })
                }
            }
        </div>
    </form>

</body>
</html>
